{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "cmake-configure",
            "type": "shell",
            "command": "C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin\\cmake.exe",
            "args": [
                "-S", ".",
                "-B", "build",
                "-G", "Visual Studio 17 2022",
                "-A", "x64"
            ],
            "problemMatcher": [
                "$msCompile"
            ]
        },
        {
            "label": "build-matmul",
            "type": "shell",
            "command": "C:\\Program Files\\Microsoft Visual Studio\\2022\\Community\\Common7\\IDE\\CommonExtensions\\Microsoft\\CMake\\CMake\\bin\\cmake.exe",
            "args": [
                "--build", "build",
                "--config", "Release",
                "--target", "matmul_test"
            ],
            "dependsOn": [
                "cmake-configure"
            ],
            "problemMatcher": [
                "$msCompile"
            ]
        },
        {
            "label": "run-matmul",
            "type": "shell",
            "command": ".\\build\\bin\\matmul_test.exe",
            "dependsOn": "build-matmul",
            "problemMatcher": []
        },
        {
            "label": "run-matmul-and-plot",
            "type": "shell",
            "command": ".\\build\\bin\\matmul_test.exe; python .\\scripts\\plot.py",
            "dependsOn": "build-matmul",
            "problemMatcher": []
        },
        {
            "label": "sweep-and-plot",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-ExecutionPolicy", "Bypass",
                "-File", ".\\scripts\\sweep.ps1"
            ],
            "dependsOn": "build-matmul",
            "problemMatcher": []
        },
        {
            "label": "sweep-and-profile-both",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-ExecutionPolicy", "Bypass",
                "-File", ".\\scripts\\sweep.ps1",
                "-ProfileShared",
                "-ProfileTensorCore"
            ],
            "dependsOn": "build-matmul",
            "problemMatcher": []
        },
        {
            "label": "perf-runner",
            "type": "shell",
            "command": "python",
            "args": [
                ".\\scripts\\perf_runner.py"
            ],
            "dependsOn": "build-matmul",
            "problemMatcher": []
        },
        {
            "label": "perf-runner-ncu",
            "type": "shell",
            "command": "python",
            "args": [
                ".\\scripts\\perf_runner.py",
                "--ncu",
                "shared_mem_matmul_kernel",
                "tensor_core_kernel"
            ],
            "dependsOn": "build-matmul",
            "problemMatcher": [],
            "options": {
                "env": {
                    "NCU_PATH": "C:\\Program Files\\NVIDIA Corporation\\Nsight Compute 2024.2.1\\ncu.exe"
                }
            }
        },
        {
            "label": "perf-runner-ncu-and-serve",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-ExecutionPolicy", "Bypass",
                "-Command", "python .\\scripts\\perf_runner.py --ncu shared_mem_matmul_kernel tensor_core_kernel; python -m http.server 8000"
            ],
            "dependsOn": "build-matmul",
            "problemMatcher": [],
            "isBackground": true,
            "options": {
                "env": {
                    "NCU_PATH": "C:\\Program Files\\NVIDIA Corporation\\Nsight Compute 2024.2.1\\ncu.exe"
                }
            }
        },
        {
            "label": "serve-dashboard",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-ExecutionPolicy", "Bypass",
                "-Command", "python -m http.server 8000"
            ],
            "problemMatcher": [],
            "isBackground": true
        },
        {
            "label": "perf-runner-and-serve",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-ExecutionPolicy", "Bypass",
                "-Command", "python .\\scripts\\perf_runner.py; python -m http.server 8000"
            ],
            "dependsOn": "build-matmul",
            "problemMatcher": [],
            "isBackground": true
        }
    ]
}
